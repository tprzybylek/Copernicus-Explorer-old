extends layout

block content
    script(type='text/javascript', src='/javascripts/leaflet/leaflet.js')
    script(src="/javascripts/jquery-3.2.1.min.js")

    h1= title
    if items.length
        div(id='map')
            script.
                !{mapScript}
        script.
                
                $(document).ready(function(){
                    $("tr, path").hover(function(){
                        var selectedClass = "." + $(this).attr('class').split(' ')[0];
                        $(selectedClass).toggleClass("selected");
                    });


                    $(".removeFromCart").click(function(){
                        var ID = $(this).attr("id");
                        var IDs = JSON.parse(Cookies.get('IDs'));
                        var index = IDs.indexOf(ID);

                        if (IDs && index > -1){
                            IDs.splice(index, 1);
                        };

                        Cookies.set('IDs', JSON.stringify(IDs));
                        alert(IDs);
                    });

                    $(".addToCart").click(function(){
                        var ID = $(this).attr("id");
                        var IDs = JSON.parse(Cookies.get('IDs'));
                        if (IDs) {
                            IDs.push(ID);
                        } else {
                            var IDs = [ID];
                        };
                        Cookies.set('IDs', JSON.stringify(IDs));
                        alert(IDs);
                    });

                });


        table
            tr
                th= 'id'
                th= 'title'
                th= 'ingestiondate'
                th= 'mode'
                th= 'orbitdirection'
                th= 'relativeorbitnumber'
                th= 'satellite'
                th= 'size'
                th= 'percent'
                

            each item in items
                tr(class= item.ID)
                    td= item.ID
                    td= item.Title
                    td= item.Ingestiondate
                    td= item.Mode
                    td= item.Orbitdirection
                    td= item.Relativeorbitnumber
                    td= item.Satellite
                    td= item.Size
                    td= item.Percent
                    td 
                        a(href="https://scihub.copernicus.eu/dhus/odata/v1/Products('" + item.ID + "')/$value") pobierz
                    td 
                        a(href="#", id=item.ID, title=item.Title, class='addToCart') do koszyka
                    td 
                        a(href="../crop?extent=" + extent + "&ID=" + item.ID + "&title=" + item.Title) przytnij
