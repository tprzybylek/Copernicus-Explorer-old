extends layout

block content
    script(type='text/javascript', src='/javascripts/leaflet/leaflet.js')
    script(src="/javascripts/jquery-3.2.1.min.js")
    script(src="/javascripts/js.cookie.js")

    h1= title
    if items.length
        div(id='map')
            script.
                !{mapScript}
        script.
                $(document).ready(function(){
                    $("tr, path").click(function(){
                        var selectedClass = "." + $(this).attr('class').split(' ')[0];
                        $(selectedClass).toggleClass("selected");
                    });

                    var IDs = Cookies.get('IDs');

                    $(".addToCart").click(function(){
                        var ID = $(this).attr("id");
                        
                        if (IDs == "" || !IDs){
                            IDs = ID;
                        } else {
                            IDs = IDs + "," + ID
                            };

                        Cookies.set('IDs', IDs);
                    });

                });


        table
            tr
                th= 'id'
                th= 'title'
                th= 'ingestiondate'
                th= 'mode'
                th= 'orbitdirection'
                th= 'relativeorbitnumber'
                th= 'satellite'
                th= 'size'
                th= 'percent'
                

            each item in items
                tr(class= item.ID)
                    td= item.ID
                    td= item.Title
                    td= item.Ingestiondate
                    td= item.Mode
                    td= item.Orbitdirection
                    td= item.Relativeorbitnumber
                    td= item.Satellite
                    td= item.Size
                    td= item.Percent
                    td 
                        a(href="https://scihub.copernicus.eu/dhus/odata/v1/Products('" + item.ID + "')/$value") pobierz
                    td 
                        a(href="#", id=item.ID, title=item.Title, class='addToCart') do koszyka
                    td 
                        a(href="../crop?extent=" + extent + "&ID=" + item.ID + "&title=" + item.Title) przytnij
